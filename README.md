# Комплекс конвейерной защиты.

Комплекс конвейерной защиты (металлодитектор в простонародье) разрабатывался инженерами ООО «Технорос» для установки на транспортных коммуникациях (в основном на конвейерах) промышленных компаний для обнаружения засоряющих элементов и выдачи управляющих сигналов на устройства извлечения или останова конвейера для организации ручного извлечения найденных фрагментов.
Засоряющими элементами являются металлические куски выше устанавливаемого размера. Это могут быть металлические куски как из т. н. магнитных, слабо магнитных и немагнитных сталей и сплавов. Последние особенно опасны, т. к. не реагируют на оборудование металоизвлечения предприятия, работающих на электромагнитном принципе.
Устройство таким образом предназначено для предотвращения:
* попадания в устройства измельчения (дробилки среднего и мелкого дробления) и, как следствие, избегать их поломок и дорогостоящего ремонта;
* порчи и/или сбоев в работе конвейерного оборудования (обрывы и/или порезы контейнерной ленты, засорение пересыпных бункеров, шиберов и т. п.)
* прокламаций со стороны покупателей о поставках некондиционного сырья и, как следствие аварий на оборудовании партнеров, вызванных наличием засоряющих элементов в поставляемом сырье.

## Состав оборудования.

* Генератор прямоугольного электромагнитного сигнала в том числе передающей катушки излучения, монтируемой над транспортной (конвейерной) лентой, разработки ООО «Технорос».
* Комплекс приемных электромагнитных катушек, оснащенных предварительным усилителем, располагающихся под транспортной (конвейерной) лентой, разработки ООО «Технорос»
* Основной вычислительный комплекс, выполненный на базе Одноплатного компьютера формата PC/104-Plus Advantech PCM-3362
![Advantech PCM-3362](https://raw.githubusercontent.com/longway34/kkz/main/Common/demo_images/PCM-3362.png "Advantech PCM-3362")

в комплекте с АЦП RTD Embedded Technologies, Inc. DM-7520
![RTD Embedded Technologies, Inc. DM-7520](https://raw.githubusercontent.com/longway34/kkz/main/Common/demo_images/DM-7520.png "RTD Embedded Technologies, Inc. DM-7520")

---

* Устройство защиты оборудования от прохождения негабаритных фрагментов под управлением программируемого реле ОВЕН ПР-200
![ОВЕН ПР-200](https://raw.githubusercontent.com/longway34/kkz/main/Common/demo_images/PR-200.png "ОВЕН ПР-200")

связь между ПР-200 и вычислительным комплексом организована по протоколу Modbus-RTU RS-485. Устройство защиты в своем составе снабжено набором датчиков движения ленты, прохождения негабарита, аварийным подъемным устройством, набором концевых выключателей, и т. п. ПР-200 дополнительно использовался для:
* управления т. н. светоуказательной рампой при организации ручной выборки обнаруженных фрагментов;
* включения в систему АСУТП, выступая в роли Mobsus-источника данных.

---

* Пульт местного управления, выполненный на базе панели ОВЕН ИП-320
![ОВЕН ИП-320](https://raw.githubusercontent.com/longway34/kkz/main/Common/demo_images/IP-320.jpg "ОВЕН ИП-320")

для вывода оперативной информации и изменения оперативных параметров работы оборудования. Связь между ИП-320 и вычислительным комплексом организована по протоколу Modbus-RTU RS-485.

## Состав программного обеспечения. Вычислительный модуль.

Все предстваленные исходные тексты взяты из рабочих релизов. Незначительно видоизменены с учетом подготовки данной демонстрации. Удалены коментарии. Не представлены набор руководст (Руководство оператора, Руководство программиста. Руководство по установке и экстлуатации)

### Основная программа.

Вычислительный модуль работает под управлением ОС Linux Ubuntu 10.04 LTE server.
ПО, выполняющее все вычислительные операции, формирование принятия решения и подачи сигналов управления представлено как данного репозитория [md_release_5](https://github.com/longway34/kkz/tree/main/md_release_5 "md_release_5"). Запускается при старте системы или в консольном режиме. Управление осуществляется:
* сигналами POSIX формата;
* с клавиатуры (в консольном режиме);
* командами пользовательского интерфейса (см. Ниже).
 
При написании (представленной демо-версии) были использованы следующие программные средства и библиотеки:
* С++, libc6-amd46 2.23-0ubuntu11.2;
* lbxml2, 2.9.3+dfsg1-1ubuntu0.7;
* libmodbus5, 3.0.6-1;
* применялась многопоточность libpthread-stubs0-dev, 0.3.4;
* драйверы устройства DM-7520, доработанные под спецификации ОС Linux Ubuntu;

### Интерфейсная программа.
Предназначена для организации пользовательского интерфейса. Выполнена в виде отдельного программного модуля. Запускается при старте системы или в консольном режиме.  Организует HTTP сервер на порту 8000. С основной программой обмен данными и командами управления осуществляется через канал расширенной оперативной памяти. Данная сложность проекта обусловлена тем, что пользовательский интерфейс комплекса необходим лишь в процессе проведения методологических работ и пуска-наладки внедрения на конкретном производственном предприятии и учета специфики условий эксплуатации для  данного заказчика. В процессе эксплуатации данный модуль не используется во избежание лишних мест возникновения сбоев ПО.

ПО представлено как данного репозитория [web_release_5](https://github.com/longway34/kkz/tree/main/web_release_5 "web_release_5")
При написании (представленной демо-версии) были использованы следующие программные средства и библиотеки:
* С++, libc6-amd46 2.23-0ubuntu11.2;
* lbxml2, 2.9.3+dfsg1-1ubuntu0.7;
* libevent-dev, 2.0.21-stable-2ubuntu0.16.04.1 (http-server);

### Пользовательский интерфейс.

Пользовательский интерфейс комплекса необходим для проведения методологических работ, пуска-наладки, исправления нештатных ситуаций и учета специфики условий эксплуатации для  данного заказчика. Представляет собой несколько (в представленном проекте 2) экрана отображения детальной оперативной информации о процессе с возможностью исправления отдельных параметров расчета и принятия решения, выбора порогов срабатывания, параметров подсистемы устранения ошибок работы приемно-передающей аппаратуры, обусловленных наложением производственными условиями мест установки оборудования. Отдельные релизы были оснащены возможностью формирования и вывода отчетов о работе оборудования.
![index_1.html](https://raw.githubusercontent.com/longway34/kkz/main/Common/demo_images/index_1.png "index_1.html")
Экран настройки порогов. 

![div_index.html](https://raw.githubusercontent.com/longway34/kkz/main/Common/demo_images/div_index.png "div_index.html")
Экран методологических работ.

ПО представлено как часть данного репозитория [web-07_1](https://github.com/longway34/kkz/tree/main/Web-07_1).
При написании (представленной демо-версии) были использованы следующие программные средства и библиотеки:
* HTML5, JavaScript;
* jQuery JavaScript Library v2.1.3. Copyright 2005, 2014 jQuery Foundation, Inc. and other contributors.
* Blob.js 2014-07-24 By Eli Grey, http://eligrey.com, Devin Samarin, https://github.com/dsamarin.
* Javascript plotting library for jQuery, version 0.8.3. Copyright (c) 2007-2014 IOLA and Ole Laursen (графики)

Средство разработки.
Для разработки и представления данной демо-версии использовались:
* IDE:
![NetBeans](https://raw.githubusercontent.com/longway34/kkz/main/Common/demo_images/NetBeans.png "NetBeans")

* Среда разработки подготовлена с использованием:
![VirtualBox](https://raw.githubusercontent.com/longway34/kkz/main/Common/demo_images/VirtualBox.png "VirtualBox")

---

Начиная с 2018 года устройстви последовательно модернизируется:
* Вычислительный модуль и панель оперативного управления перенесены на платформу МК производства STMicroelectronics STM32.
* Усовершенствованы алгоритмы помехозащиты от внешнего воздействия.
* Удалось упростить проведение методологических работ.
* Значительно повышен порог чувствительности за счет модернизации аналогового тракта измерительной системы.
* Повышена точность позиционирования за счет установки дополнительно измерителя скорости конвейера.
* Повышена отказоустойчивость силового оборудования включением в его состав бесконтактного пускателя производства ООО "НПФ "Битек" МСТ-330Р.

Все работы проводятся силами инженорного состава ООО "Технорос".



